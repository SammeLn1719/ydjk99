# –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —á–∞—Ç–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### 1. Observer Pattern (–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `backend/src/patterns/Observer.ts`

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
- `Observer` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è
- `Subject` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—É–±—ä–µ–∫—Ç–∞
- `EventSubject` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—É–±—ä–µ–∫—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–æ–±—ã—Ç–∏–π
- `LoggingObserver` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- `MetricsObserver` - —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```typescript
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–π
roomManager.attach(loggingObserver);
roomManager.attach(metricsObserver);

// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏—è—Ö
roomManager.notify('userJoinedRoom', { roomId, user });
```

### 2. –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `RoomManager.getRoomParticipantsVirtual()`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–º–Ω–∞—Ç
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```typescript
const result = roomManager.getRoomParticipantsVirtual(roomId, page, pageSize);
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: { participants, total, page, pageSize, hasMore }
```

## üè† –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–Ω–∞—Ç

### –¢–∏–ø—ã –∫–æ–º–Ω–∞—Ç

1. **PUBLIC** (üåê) - –ü—É–±–ª–∏—á–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã
   - –î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

2. **PRIVATE** (üîí) - –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã
   - –¢–æ–ª—å–∫–æ –ø–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—é
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø

3. **RESTRICTED** (üõ°Ô∏è) - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã
   - –¢—Ä–µ–±—É—é—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
   - –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –¥–æ—Å—Ç—É–ø

4. **ANNOUNCEMENT** (üì¢) - –ö–æ–º–Ω–∞—Ç—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π
   - –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–∞–º–∏

```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
const room = roomManager.createRoom({
  name: '–ù–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞',
  type: RoomType.PUBLIC,
  maxParticipants: 100
});

// –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ
roomManager.joinRoom(roomId, userId, userName, UserRole.USER);

// –ü–æ–∫–∏–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
roomManager.leaveRoom(roomId, userId);

// –ü–æ–∏—Å–∫ –∫–æ–º–Ω–∞—Ç
const rooms = roomManager.searchRooms('–ø–æ–∏—Å–∫', userId);
```

## üë• –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π

### –ò–µ—Ä–∞—Ä—Ö–∏—è —Ä–æ–ª–µ–π

1. **ADMIN** (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
   - –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–æ–º–Ω–∞—Ç–æ–π
   - –ú–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ä–æ–ª–∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ú–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –∫–æ–º–Ω–∞—Ç—ã
   - –ú–æ–∂–µ—Ç –º–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è

2. **MODERATOR** (–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä)
   - –ú–æ–∂–µ—Ç –º–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
   - –ú–æ–∂–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–∫–ª—é—á–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ú–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∫–æ–º–Ω–∞—Ç—ã

3. **USER** (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
   - –ú–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
   - –ú–æ–∂–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è—Ç—å—Å—è –∫ –ø—É–±–ª–∏—á–Ω—ã–º –∫–æ–º–Ω–∞—Ç–∞–º
   - –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∞

4. **OBSERVER** (–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å)
   - –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ù–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
   - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏

```typescript
// –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
roomManager.updateUserRole(roomId, userId, UserRole.MODERATOR, adminUserId);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
const hasPermission = room.participants.find(p => 
  p.userId === userId && p.role === UserRole.ADMIN
);
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏

### –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫

**MetricsObserver** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç

```typescript
// –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
const metrics = metricsObserver.getMetrics();
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: Map<string, number>

// –°–±—Ä–æ—Å –º–µ—Ç—Ä–∏–∫
metricsObserver.resetMetrics();
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–Ω–∞—Ç

```typescript
const stats = roomManager.getRoomStats(roomId);
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
{
  totalParticipants: number,
  onlineParticipants: number,
  admins: number,
  moderators: number,
  users: number,
  observers: number
}
```

## üîç –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

### –ü–æ–∏—Å–∫ –∫–æ–º–Ω–∞—Ç

```typescript
// –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ –æ–ø–∏—Å–∞–Ω–∏—é
const rooms = roomManager.searchRooms('–ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å', userId);

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É
const publicRooms = roomManager.getRoomsByType(RoomType.PUBLIC);
```

### –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

```typescript
// –ü–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
const participants = roomManager.getRoomParticipantsVirtual(
  roomId, 
  page,      // –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (0-based)
  pageSize   // –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
);
```

## üåê WebSocket —Å–æ–±—ã—Ç–∏—è

### –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è

1. **getRooms** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–º–Ω–∞—Ç
2. **joinRoom** - –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ
3. **leaveRoom** - –ø–æ–∫–∏–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
4. **getRoomParticipants** - –ø–æ–ª—É—á–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
5. **searchRooms** - –ø–æ–∏—Å–∫ –∫–æ–º–Ω–∞—Ç
6. **getRoomStats** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

```typescript
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∫–æ–º–Ω–∞—Ç
const unsubscribe = websocketService.onRoomEvent((event, data) => {
  switch (event) {
    case 'roomsList':
      setRooms(data);
      break;
    case 'userJoinedRoom':
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
      break;
    case 'roomStats':
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
      break;
  }
});
```

## üé® –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### RoomList

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–º–Ω–∞—Ç
- –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ/–ø–æ–∫–∏–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç
- –í–∫–ª–∞–¥–∫–∏ "–ü—É–±–ª–∏—á–Ω—ã–µ" –∏ "–ú–æ–∏"

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ç–∏–ø–∞ –∫–æ–º–Ω–∞—Ç—ã
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫**
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
   - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

2. **Observer Pattern**
   - –°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

3. **WebSocket –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
   - –°–æ–±—ã—Ç–∏–π–Ω–∞—è –º–æ–¥–µ–ª—å
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–Ω–∞—Ç**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—ã—Å—è—á —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫

2. **–°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π**
   - –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤
   - –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
   - –†–∞—Å—à–∏—Ä—è–µ–º—ã–µ —Ä–æ–ª–∏

3. **Observer Pattern**
   - –õ–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–π
   - –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   - –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```typescript
// –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
const DEFAULT_PAGE_SIZE = 20;

// –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
const DEFAULT_MAX_PARTICIPANTS = 50;

// –¢–∏–ø—ã –∫–æ–º–Ω–∞—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
const DEFAULT_ROOM_TYPES = [
  RoomType.PUBLIC,
  RoomType.ANNOUNCEMENT,
  RoomType.RESTRICTED
];
```

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
**–í–µ—Ä—Å–∏—è**: 2.0.0
**–î–∞—Ç–∞**: 15 –∞–≤–≥—É—Å—Ç–∞ 2025

